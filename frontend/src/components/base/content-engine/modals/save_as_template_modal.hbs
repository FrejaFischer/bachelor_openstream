{{!-- SPDX-FileCopyrightText: 2025 Magenta ApS <https://magenta.dk> --}}
{{!-- SPDX-License-Identifier: AGPL-3.0-only --}}
{{#> base/modal/modal id="saveAsTemplateModal" ariaLabelledby="saveAsTemplateModalLabel" }}
    {{#*inline "header"}}
        {{> base/modal/modal-title title="Save Slide as Template" id="saveAsTemplateModalLabel"}}
        {{> base/modal/modal-header-close}}
    {{/inline}}

    {{#*inline "body"}}
        <form id="saveAsTemplateForm">
            <div class="mb-3">
                {{> base/form/label for="templateName" text="Template Name"}}
                {{> base/form/input type="text" id="templateName" required=true}}
            </div>

            <div class="mb-3">
                {{> base/form/label for="templateCategory" text="Category (optional)"}}
                {{#> base/form/dropdown id="templateCategory"}}
                    {{> base/form/dropdown-option value="" text="-- None --"}}
                    <!-- Fill options dynamically in JS from /api/categories/ -->
                {{/base/form/dropdown}}
            </div>

            <div class="mb-3">
                {{> base/form/label for="tagsDropdownToggle" text="Tags (optional)"}}
                <div class="dropdown">
                    <button class="btn btn-outline-secondary dropdown-toggle w-100 text-start d-flex justify-content-between align-items-center"
                            type="button"
                            id="tagsDropdownToggle"
                            data-bs-toggle="dropdown"
                            aria-expanded="false">
                        <span class="selected-tags-text">Select tags...</span>
                        <span class="selected-tags-count badge bg-primary rounded-pill ms-1" style="display: none">0</span>
                    </button>
                    <div class="dropdown-menu p-3 w-100" id="tagsDropdownMenu">
                        <div class="mb-2 border-bottom pb-2">
                            {{> base/form/checkbox id="selectAllTags" text="Select All" bold=true}}
                        </div>
                        <div id="tagCheckboxes">
                            <!-- Tag checkboxes will be dynamically added here -->
                        </div>
                    </div>
                </div>
                {{> base/form/input type="hidden" id="templateTags"}}
            </div>

            <div class="mb-3">
                {{> base/form/label text="Suitable Aspect Ratios"}}
                <p class="text-muted small">Select aspect ratios this template is designed to work with. This helps users find templates appropriate for their display size.</p>

                <div class="card mb-2">
                    <div class="card-header">
                        {{> base/form/checkbox id="selectAllLandscape" text="Landscape"}}
                    </div>
                    <div class="card-body" id="landscapeRatios">
                        <div class="row mb-2">
                            <div class="col-md-4">{{> base/form/checkbox id="ratio16_9" class="landscape-ratio" name="aspectRatios" value="16:9" text="16:9"}}</div>
                            <div class="col-md-4">{{> base/form/checkbox id="ratio4_3" class="landscape-ratio" name="aspectRatios" value="4:3" text="4:3"}}</div>
                            <div class="col-md-4">{{> base/form/checkbox id="ratio21_9" class="landscape-ratio" name="aspectRatios" value="21:9" text="21:9"}}</div>
                        </div>
                        <div class="row">
                            <div class="col-md-4">{{> base/form/checkbox id="ratio1_85_1" class="landscape-ratio" name="aspectRatios" value="1.85:1" text="1.85:1"}}</div>
                            <div class="col-md-4">{{> base/form/checkbox id="ratio2_39_1" class="landscape-ratio" name="aspectRatios" value="2.39:1" text="2.39:1"}}</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        {{> base/form/checkbox id="selectAllPortrait" text="Portrait"}}
                    </div>
                    <div class="card-body" id="portraitRatios">
                        <div class="row mb-2">
                            <div class="col-md-4">{{> base/form/checkbox id="ratio9_16" class="portrait-ratio" name="aspectRatios" value="9:16" text="9:16"}}</div>
                            <div class="col-md-4">{{> base/form/checkbox id="ratio3_4" class="portrait-ratio" name="aspectRatios" value="3:4" text="3:4"}}</div>
                            <div class="col-md-4">{{> base/form/checkbox id="ratio9_21" class="portrait-ratio" name="aspectRatios" value="9:21" text="9:21"}}</div>
                        </div>
                        <div class="row">
                            <div class="col-md-4">{{> base/form/checkbox id="ratio1_1_85" class="portrait-ratio" name="aspectRatios" value="1:1.85" text="1:1.85"}}</div>
                            <div class="col-md-4">{{> base/form/checkbox id="ratio1_2_39" class="portrait-ratio" name="aspectRatios" value="1:2.39" text="1:2.39"}}</div>
                        </div>
                    </div>
                </div>
            </div>

            {{> base/form/input type="hidden" id="templateOrgId"}}
        </form>
    {{/inline}}

    {{#*inline "footer"}}
        {{> base/modal/modal-footer-close btn-text="Cancel"}}
        {{> base/buttons/icon-button type='button' id='confirmSaveTemplateBtn' variant='primary' icon='save' text='Save'}}
    {{/inline}}
{{/base/modal/modal}}
