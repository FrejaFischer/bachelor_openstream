{{!-- SPDX-FileCopyrightText: 2025 Magenta ApS <https://magenta.dk> --}}
{{!-- SPDX-License-Identifier: AGPL-3.0-only --}}
{{#> base/modal/modal id="saveAsTemplateModal" ariaLabelledby="saveAsTemplateModalLabel" size="modal-xl" }}
    {{#*inline "header"}}
        {{> base/modal/modal-title title="Save Slide as Template" id="saveAsTemplateModalLabel"}}
        {{> base/modal/modal-header-close}}
    {{/inline}}

    {{#*inline "body"}}
        <form id="saveAsTemplateForm">
            <div class="mb-3">
                {{> base/form/label for="templateName" text="Template Name"}}
                {{> base/form/input type="text" id="templateName" required=true}}
            </div>

            <div class="mb-3">
                {{> base/form/label for="templateCategory" text="Category (optional)"}}
                {{#> base/form/dropdown id="templateCategory"}}
                    {{> base/form/dropdown-option value="" text="-- None --"}}
                    <!-- Fill options dynamically in JS from /api/categories/ -->
        {{/base/form/dropdown}}
            </div>

            <div class="mb-3">
                {{> base/form/label for="tagsDropdownToggle" text="Tags (optional)"}}
                <div class="dropdown">
                    <button class="btn btn-outline-secondary dropdown-toggle w-100 text-start d-flex justify-content-between align-items-center"
                            type="button"
                            id="tagsDropdownToggle"
                            data-bs-toggle="dropdown"
                            aria-expanded="false">
                        <span class="selected-tags-text">Select tags...</span>
                        <span class="selected-tags-count badge bg-primary rounded-pill ms-1" style="display: none">0</span>
                    </button>
                    <div class="dropdown-menu p-3 w-100" id="tagsDropdownMenu">
                        <div class="mb-2 border-bottom pb-2">
                            {{> base/form/checkbox id="selectAllTags" text="Select All" bold=true}}
                        </div>
                        <div id="tagCheckboxes">
                            <!-- Tag checkboxes will be dynamically added here -->
                        </div>
                    </div>
                </div>
                {{> base/form/input type="hidden" id="templateTags"}}
            </div>

            <div class="mb-3 js-template-aspect-ratio-group">
                {{> base/form/label for="templateAspectRatio" text="Aspect Ratio"}}
                <p class="text-muted small mb-3">{% trans "Select the aspect ratio this template is designed for. The preview will automatically adjust to this aspect ratio." %}</p>

                <div class="card mb-2">
                    <div class="card-header py-2">
                        <h6 class="mb-0">{% trans "Landscape" %}</h6>
                    </div>
                    <div class="card-body py-2">
                        <div class="d-flex justify-content-start align-items-end flex-wrap gap-2 js-template-aspect-ratio-options" data-orientation="landscape"></div>
                    </div>
                </div>

                <div class="card mb-2">
                    <div class="card-header py-2">
                        <h6 class="mb-0">{% trans "Portrait" %}</h6>
                    </div>
                    <div class="card-body py-2">
                        <div class="d-flex justify-content-start align-items-end flex-wrap gap-2 js-template-aspect-ratio-options" data-orientation="portrait"></div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header py-2">
                        <h6 class="mb-0">{% trans "Square" %}</h6>
                    </div>
                    <div class="card-body py-2">
                        <div class="d-flex justify-content-start align-items-end flex-wrap gap-2 js-template-aspect-ratio-options" data-orientation="square"></div>
                    </div>
                </div>

                {{> base/form/input type="hidden" id="templateAspectRatio" name="aspectRatio"}}
            </div>

            {{> base/form/input type="hidden" id="templateOrgId"}}
        </form>
    {{/inline}}

    {{#*inline "footer"}}
        {{> base/modal/modal-footer-close btn-text="Cancel"}}
        {{> base/buttons/icon-button type='button' id='confirmSaveTemplateBtn' variant='primary' icon='save' text='Save'}}
    {{/inline}}
{{/base/modal/modal}}
